<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>binary_format - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../CONTRIBUTING_md.html">CONTRIBUTING</a>
  
    <li><a href="../../History_txt.html">History</a>
  
    <li><a href="../../LICENSE_txt.html">LICENSE</a>
  
    <li><a href="../../README_rdoc.html">README</a>
  
    <li><a href="../../ext/nmatrix/binary_format_txt.html">binary_format</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page ext/nmatrix/binary_format.txt">

<p>This is the proposed binary format for saving and loading <a
href="../../NMatrix.html">NMatrix</a> objects.</p>

<p>Order is little-endian.</p>

<p>List matrices should be converted to dense or yale matrices. There should
be no serious need to load or save linked-list matrices, since these exist
primarily in order to construct efficient yale matrices.</p>

<p>First 64-bit block:</p>
<ul><li>
<p>ui16 major (version)</p>
</li><li>
<p>ui16 minor</p>
</li><li>
<p>ui16 release</p>
</li><li>
<p>i16 NULL</p>
</li></ul>

<p>Second 64-bit block:</p>
<ul><li>
<p>ui8 dtype</p>
</li><li>
<p>ui8 stype</p>
</li><li>
<p>ui8 itype # ui32 for dense</p>
</li><li>
<p>ui8 symm</p>
</li><li>
<p>i16 NULL</p>
</li><li>
<p>ui16 dim    # if 1, NVector; otherwise, <a
href="../../NMatrix.html">NMatrix</a></p>
</li></ul>

<p>3rd - nth 64-bit block: shape</p>

<p>itype sets the number of bytes allocated for each shape entry. Since only
yale uses itype, dense will pretty much always be the UINT32 itype (see
nmatrix.h). If the total number of bytes occupied by the shape array is
less than 8, the rest of the 64-bit block will be padded with zeros.</p>

<p>(n+1)th 64-bit block: depends on stype, symm</p>

<p>symm is designed to reduce file size by allowing us to not save certain
elements in symmetric, hermitian, skew- symmetric, and triangular matrices.
These values will be defined in nmatrix.h; 0 indicates standard (no
symmetry). In later versions, additional patterns may be defined which
might even have less to do with symmetry than upper/lower do.</p>

<p>When storing a symmetric matrix, we will only store the upper portion. If
the matrix is lower triangular, only the lower portion will be stored.</p>

<p>For dense, we simply store the contents of the matrix exactly as in memory
(or just the upper-triangular part if symm is set).</p>

<p>For yale, we store:</p>
<ul><li>
<p>ui32 ndnz</p>
</li><li>
<p>ui32 length (AKA size, the number of elements in A/IJA that aren&#39;t
nil/undefined)</p>
</li></ul>

<p>The latter will serve as the capacity when we read a Yale matrix.</p>

<p>Then we store the a array, again padding with zeros so it&#39;s a multiple
of 8 bytes.</p>

<p>Then we store the ija array, padding with zeros so it&#39;s a multiple of 8
bytes.</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

